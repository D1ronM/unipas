# Операционные системы
<!-- TODO: файловые системы -->
<!-- TODO: ВСЁ ЦЕЛИКОМ ПОД ПЕРЕПИСЬ. Приведи аналогию с виртуальным миром, в котором живут люди -->

![Морфеус из матрицы: "Нео, ты точно хочешь узнать, что такое операционная система?"](/artwork/cs-101/operating-system.jpg)

## Что такое ~~Матрица~~ операционная система?
Просто супер, теперь у нас есть универсальный работник Боб, которого можно заставить
выполнять практически любую работу, надо только написать последовательность инструкций
(компьютерную программу), объясняющую, как эту работу выполнять.

Просто ужас: нам надо выполнять сразу две программы одновременно, а Боб у нас только
один, и второго мы позволить не можем из-за долбанной инфляции. А ещё практически в каждой
программе, которую мы пишем, приходится реализовывать один и тот же функционал. Например,
работу с устройствами ввода/вывода: жёсткими дисками и SSD, сетевыми интерфейсами
и так далее.

Наша команда программистов долго думала над этими проблемами и наконец придумала: мы создадим
программу-виртуальный мир, внутри которой будут жить все остальные программы. В этот
самый "виртуальный мир" будет встроена логика, заставляющая Боба периодически переключаться
с выполнения одной программы на выполнение другой. И будет создаваться эффект, как будто
бы несколько программ выполняются одновременно. А ещё мы возьмём весь тот функционал, который
нужен практически каждой программе, и встроим прямо в виртуальный мир, чтобы не дублировать
его каждый раз. А ещё мы устали писать программы вручную, поэтому мы разработаем
набор предустановленных программ и утилит для нашего мира, которые в будущем облегчат
разработку новых программ под него.

А, подождите-ка, вообще-то наши прогеры не придумали ничего нового. Такие
программы-виртуальные миры уже существуют, их называют "операционные системы" ("ОС").

Любая операционная система состоит из "ядра" и набора предустановленных программ. В былые времена
в этот самый набор предустановленных программ входили только инструменты, облегчающие
работу программистам. Однако, когда компьютеры стали использоваться обычными, неподготовленными
людьми, набор программ начал меняться соответствующим образом. По итогу на сегодняшний день мы
имеем операционные системы, в которые из коробки входят графические оболочки, веб-браузеры и игры,
а какие либо инструменты для разработки полностью отсутствуют за ненадобностью (Взять в пример
хотя бы Windows)

## Ядро и планировщик
Ядро операционной системы, по сути, описывает все законы этого самого "виртуального мира":
позволяет нескольким программам выполняться "одновременно", общаться друг с другом, а также
убирает нужду напрямую общаться с железом компьютера, потому что это крайне сложно. 

Часть ядра, заставляющая Боба переключаться между выполнением различных программ, называется
"планировщик". Иногда может встречаться название "шедулер" ("scheduler") на английский манер. 

Переключение происходит следующим образом: у Боба есть таймер, с помощью которого
он отсчитывает, какое время осталось у программы на выполнение. Когда это время заканчивается,
он сохраняет все числа, которые держал в голове, в память и "перепрыгивает" на инструкции
планировщика. Планировщик выбирает следующую программу на выполнение, учитывая приоритет
каждой программы, после чего Боб сбрасывает таймер и начинает выполнять её, пока время на
таймере снова не закончится.

## Драйверы
<!-- Под перепись: это абсолютно неправильно -->
Напрямую работать с железом компьютера очень тяжело. Возьмём, например, программируемую
клавиатуру. Если послать ей некорректные данные, есть небольшой шанс активировать
перезапись прошивки и превратить её в кирпич. Да, вероятность небольшая, однако,
если каждый программист сам будет реализовывать внутри своей программы логику для
работы с клавиатурами, рано или поздно кто-нибудь из них реализует эту логику неправильно
и окирпичит чью-нибудь клавиатуру. А теперь попробуйте подставить в пример дорогущую
видеокарту, с которой ещё и работать намного сложнее, чем с клавиатурой. Это одна из причин,
почему существуют **драйверы** - компоненты ядра операционной системы, предоставляющие
программам упрощённый интерфейс для взаимодействия с различным железом компьютера. 

Чаще всего драйверы для железки пишут люди, создавшие саму железку. Правда иногда они
предоставляют драйверы всего для одной или двух операционных систем, забивая
на все остальные. В таких случаях добровольцам приходится изучать, как работает железка,
и самостоятельно писать под неё драйверы для не поддерживаемых официально ОС.

## Файловая система
Ещё одним важным компонентом ядра является **файловая система**. Устройства по типу
жёстких дисков и SSD, сами по себе, абсолютно ничего не знают про файлы и директории (папки).
Всё, что они умеют, - хранить какую-то информацию, а на содержание и структуру этой самой
информации им наплевать. Понятное дело, что, когда диск использует сразу множество
программ, надо как-то регулировать его использование, чтобы не возникало конфликтов.

Более того, чтобы записать информацию на жёсткий диск, необходимо отыскать на нём свободное
место. А как вообще понять, какое место свободное, а какое - нет? В случайно выбранную
часть жёсткого диска может быть записана любая хрень. Просто взглянув на неё невозможно
понять, актуальная эта информация или же это какой-то мусор, который уже никому не нужен.
Следовательно, необходимо отслеживать в отдельном месте, какие части диска уже заняты,
а какие свободны.

Файловая система нужна как раз для того, чтобы решить эти проблемы. Она организует
и структурирует все данные, сохраняемые на жёсткий диск: позволяет разбивать информацию на
отдельные, самостоятельные единицы, под названием "файлы", а ещё даёт возможность организовывать
их расположение с помощью директорий. Благодаря файловой системе программам вообще
не надо беспокоиться о том, в какую часть диска будут записаны их данные, необходимо знать
лишь название файла и путь до него. А о расположении содержимого файла на самом диске
уже беспокоится файловая система. Она же ищет свободное место при создании новых файлов
и выдаёт ошибки, когда этого места недостаточно.

## Исполняемые файлы
Плюс организации информации на дисках в форме файлов в том,
что внутри файлов можно хранить не только данные, с которыми
работают программы, но и сами программы. Файл, содержащий программу, называют
"исполняемым", потому что программу внутри него можно исполнить. Подобного рода файл хранит
не только процессорные инструкции, но ещё и дополнительную информацию для операционной системы,
структура и формат которой определяется создателями самой ОС. 

Исполняемые файлы надо каким-то образом отличать от обычных. В ОС Windows это делается
топорным, но понятным образом: файлы, названия которых заканчиваются на ".exe", считаются исполняемыми.
В операционных системах, корни которых уходят к UNIX, то есть GNU/Linux и MacOS, сама файловая
система запоминает, какие файлы исполняемые, а какие - нет. Там, чтобы сделать файл
исполняемым, не надо менять его название, надо просто поставить на нём специальную метку.
Важное заечение: эта самая метка не влияет на содержимое файла. Метка - это мета-информация,
такая же, как, например, название файла, которую файловая система хранит в отдельном,
специально отведённом месте.
